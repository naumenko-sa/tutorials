library("biomaRt")
grch37 = useMart(biomart="ENSEMBL_MART_ENSEMBL", host="grch37.ensembl.org",
path="/biomart/martservice", dataset="hsapiens_gene_ensembl")
datasets=listDatasets(grch37)
grch37 = useDataset(grch37,dataset="hsapiens_gene_ensembl")
attributes=listAttributes(grch37)
filters=listFilters(grch37)
View(attributes)
View(attributes)
View(attributes)
View(attributes)
chromosomes = getBM(attributes=c('chromosome_name'),mart=grch37)
View(chromosomes)
View(chromosomes)
chromosomes[chromosome_name!="*PATCH*"]
grep("PATCH",chromosomes$chromosome_name)
chromosomes[grep("PATCH",chromosomes$chromosome_name),]
help(grep)
chromosomes[grep("PATCH",chromosomes$chromosome_name,invert = T),]
chromosomes[grep("PATCH|HSCHR",chromosomes$chromosome_name,invert = T),]
chromosomes[grep("PATCH|HSCHR|LRG",chromosomes$chromosome_name,invert = T),]
chromosomes[grep("PATCH|HSCHR|LRG|HG",chromosomes$chromosome_name,invert = T),]
setwd("~/Desktop/project_cheo/2016-10-28_gemini_test/")
reference_tables_path="~/Desktop/reference_tables"
library(RSQLite)
library(stringr)
library(genetics)
library(data.table)
samples=c("100940")
family = "b100940"
file=paste0(family,"-ensemble.db.txt")
variants = get_variants_from_file(file)
samples=c("166_3_5","166_4_10","166_4_8")
family="166"
file=paste0(family,"-ensemble.db.txt")
variants = get_variants_from_file(file)
get_variants_from_file = function (filename)
{
variants = read.delim(filename, stringsAsFactors=FALSE)
return(variants)
}
move_column=function (variants,number)
{
columns = ncol(variants)
if (number > 2)
variants=variants[c(1:(number-1),columns,number:(columns-1))]
else
variants=variants[c(1,columns,number:(columns-1))]
return(variants)
}
add_placeholder=function(variants,column_name,placeholder,number)
{
variants[,column_name]=with(variants,placeholder)
return(move_column(variants,number))
}
variants = get_variants_from_file(file)
View(variants)
View(variants)
variants$Position=with(variants,paste(Chrom,Pos,sep=':'))
columns = ncol(variants)
variants=variants[c(columns,1:columns-1)]
sUCSC1="=HYPERLINK(\"http://genome.ucsc.edu/cgi-bin/hgTracks?hgt.out3=10x&position="
sUCSC2="\",\"UCSC link\""
variants$UCSC_Link=with(variants,paste(sUCSC1,Position,sUCSC2,sep=''))
variants=move_column(variants,2)
variants=add_placeholder(variants,new_name,"test",7)
variants = cbind(variants,lapply(variants$gts.100940,genotype2zygocity))
for(sample in samples)
{
new_name = paste0("Zygocity.",samples[1])
#setnames(variants, paste0("gts.",sample),new_name)
variants$new_name = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
genotype2zygocity = function (genotype_str)
{
#genotype_str = "A|A"
#genotype_str = "./."
#genotype_str = "TCA/."
#genotype_str = "G"
genotype_str = gsub("|","/",genotype_str,fixed=T)
return(result)
}
variants = cbind(variants,lapply(variants$gts.100940,genotype2zygocity))
for(sample in samples)
{
new_name = paste0("Zygocity.",samples[1])
#setnames(variants, paste0("gts.",sample),new_name)
variants$new_name = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
genotype2zygocity = function (genotype_str)
{
#genotype_str = "A|A"
#genotype_str = "./."
#genotype_str = "TCA/."
#genotype_str = "G"
genotype_str = gsub("|","/",genotype_str,fixed=T)
resuls = genotype_str
return(result)
}
for(sample in samples)
{
new_name = paste0("Zygocity.",samples[1])
variants$new_name = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
genotype_str = "A|A"
genotype_str = gsub("|","/",genotype_str,fixed=T)
resuls = genotype_str
genotype2zygocity = function (genotype_str)
{
genotype_str = "A|A"
#genotype_str = "./."
#genotype_str = "TCA/."
#genotype_str = "G"
genotype_str = gsub("|","/",genotype_str,fixed=T)
result = genotype_str
return(result)
}
genotype2zygocity = function (genotype_str)
{
genotype_str = "A|A"
#genotype_str = "./."
#genotype_str = "TCA/."
#genotype_str = "G"
genotype_str = gsub("|","/",genotype_str,fixed=T)
result = genotype_str
return(result)
}
samples=c("166_3_5","166_4_10","166_4_8")
family="166"
file=paste0(family,"-ensemble.db.txt")
variants = get_variants_from_file(file)
variants$Position=with(variants,paste(Chrom,Pos,sep=':'))
columns = ncol(variants)
variants=variants[c(columns,1:columns-1)]
sUCSC1="=HYPERLINK(\"http://genome.ucsc.edu/cgi-bin/hgTracks?hgt.out3=10x&position="
sUCSC2="\",\"UCSC link\""
variants$UCSC_Link=with(variants,paste(sUCSC1,Position,sUCSC2,sep=''))
variants=move_column(variants,2)
for(sample in samples)
{
new_name = paste0("Zygocity.",samples[1])
#setnames(variants, paste0("gts.",sample),new_name)
variants$new_name = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
View(variants)
View(variants)
for(sample in samples)
{
new_name = paste0("Zygocity.",samples[1])
#setnames(variants, paste0("gts.",sample),new_name)
variants[,new_name] = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
View(variants)
View(variants)
for(sample in samples)
{
new_name = paste0("Zygocity.",sample)
#setnames(variants, paste0("gts.",sample),new_name)
variants[,new_name] = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
View(variants)
View(variants)
samples=c("166_3_5","166_4_10","166_4_8")
family="166"
samples=c("100940")
samples=c("166_3_5","166_4_10","166_4_8")
family="166"
file=paste0(family,"-ensemble.db.txt")
variants = get_variants_from_file(file)
variants$Position=with(variants,paste(Chrom,Pos,sep=':'))
columns = ncol(variants)
variants=variants[c(columns,1:columns-1)]
sUCSC1="=HYPERLINK(\"http://genome.ucsc.edu/cgi-bin/hgTracks?hgt.out3=10x&position="
sUCSC2="\",\"UCSC link\""
variants$UCSC_Link=with(variants,paste(sUCSC1,Position,sUCSC2,sep=''))
variants=move_column(variants,2)
for(sample in samples)
{
new_name = paste0("Zygocity.",sample)
#setnames(variants, paste0("gts.",sample),new_name)
variants[,new_name] = with(variants,genotype2zygocity(paste0("gts.",sample)))
}
View(variants)
View(variants)
genotype_str = "A|A"
ar = strsplit(genotype_str,"/",fixed=T)
genotype_str = "A|A"
genotype_str = gsub("|","/",genotype_str,fixed=T)
ar = strsplit(genotype_str,"/",fixed=T)
ar
ar[1]
ar[[1]]
ar[[1]][1]
?grep
?gsub
genotype_str = "A|A|B"
genotype_str = gsub("|","/",genotype_str,fixed=T)
genotype_str
genotype_str
setwd("~/Desktop/teaching_n_learning/SickKids_Exploring_Variation")
setwd("~/Desktop/teaching_n_learning/tutorials")
grep(genotype_str
View(variants)
View(variants)
View(pipelines)
plot(pipelines)
df_print(pipelines)
print(pipelines)
pipelines=c("variant calling","cancer","structural variant calling","RNA-seq","smallRNA-seq","ChIP-seq")
library(knitr)
print(length(pipelines))
kable(as.data.frame(pipelines))
pipelines=data.frame(c("variant calling","cancer","structural variant calling","RNA-seq","smallRNA-seq","ChIP-seq"))
kable(pipelines)
